{{!-- Mixer Tab Content - Reuses Library styles --}}
<div class="ase-workspace ase-mixer-workspace">

  {{!-- Left Column: Favorites Panel (Full Height) --}}
  <aside class="ase-sidebar">
    <div class="ase-sidebar-section ase-mixer-favorites">
      <div class="ase-sidebar-header">
        <span class="ase-sidebar-title"><i class="fa-solid fa-star"></i> Favorites</span>
      </div>
      <ul class="ase-list-group" data-section="mixer-favorites">
        {{#each favorites}}
        <li class="ase-list-item ase-favorite-item {{#if isPlaying}}is-playing{{else if isPaused}}is-paused{{/if}}"
          data-favorite-id="{{id}}" data-favorite-type="{{type}}">
          <div class="ase-favorite-info">
            {{#if (eq type 'playlist')}}
            <i class="fa-solid fa-list ase-type-icon"></i>
            {{else}}
            {{#if (eq group 'sfx')}}
            <i class="fa-solid fa-bolt ase-type-icon"></i>
            {{else if (eq group 'ambience')}}
            <i class="fa-solid fa-cloud ase-type-icon"></i>
            {{else}}
            <i class="fa-solid fa-music ase-type-icon"></i>
            {{/if}}
            {{/if}}
            <span>{{name}}</span>
          </div>
          <div class="ase-icons">
            <i class="ase-icon-add-queue" data-action="add-to-queue-from-favorite" data-favorite-id="{{id}}"
              data-favorite-type="{{type}}" title="Add to Queue"></i>
            <i class="fa-solid fa-play" data-action="play-favorite" data-favorite-id="{{id}}"
              data-favorite-type="{{type}}" title="Play"></i>
            <i class="fa-solid fa-stop" data-action="stop-favorite" data-favorite-id="{{id}}"
              data-favorite-type="{{type}}" title="Stop"></i>
          </div>
        </li>
        {{else}}
        <li class="ase-empty-message">
          <i class="fa-solid fa-star" style="opacity: 0.3;"></i>
          <span>No favorites</span>
        </li>
        {{/each}}
      </ul>
    </div>
  </aside>

  {{!-- Right Column: Playlist Queue --}}
  <main class="ase-content-area">
    <div class="ase-filters-bar">
      <span class="ase-sidebar-title"><i class="fa-solid fa-list"></i> Playback Queue</span>
    </div>

    <div class="ase-track-player-list" data-section="mixer-queue">
      {{#if queuePlaylists.length}}
      {{#each queuePlaylists}}
      <div class="ase-queue-playlist {{#if collapsed}}is-collapsed{{/if}}" data-playlist-id="{{id}}">
        {{!-- Playlist Header --}}
        <div class="ase-queue-playlist-header" data-action="toggle-playlist">
          <i class="fa-solid fa-chevron-down ase-collapse-icon"></i>
          <span class="ase-playlist-name">{{name}}</span>
          <span class="ase-playlist-count">({{tracks.length}} tracks)</span>
        </div>

        {{!-- Playlist Tracks --}}
        <div class="ase-queue-tracks">
          {{#each tracks}}
          {{!-- Show all if not collapsed, otherwise only playing/paused --}}
          <div
            class="ase-track-player-item ase-queue-track {{#if isPlaying}}is-playing{{else if isPaused}}is-paused{{/if}}"
            data-queue-id="{{queueId}}" data-item-id="{{libraryItemId}}" {{#if ../collapsed}}{{#unless
            isPlaying}}{{#unless isPaused}}style="display: none;" {{/unless}}{{/unless}}{{/if}}>

            {{!-- Track Icon --}}
            <div class="ase-track-image">
              {{#if (eq group 'music')}}
              <i class="fa-solid fa-music"></i>
              {{else if (eq group 'ambience')}}
              <i class="fa-solid fa-cloud"></i>
              {{else}}
              <i class="fa-solid fa-bolt"></i>
              {{/if}}
            </div>

            {{!-- Row 1: Title + Controls --}}
            <div class="ase-track-header">
              <div class="ase-track-title-block">
                <span class="ase-track-name">{{name}}</span>
                <span class="ase-track-duration">{{durationFormatted}}</span>
              </div>
              <div class="ase-track-controls">
                <div class="ase-playback-controls">
                  <i class="fa-solid fa-play" data-action="play-queue" title="Play"></i>
                  <i class="fa-solid fa-pause" data-action="pause-queue" title="Pause"></i>
                  <i class="fa-solid fa-stop" data-action="stop-queue" title="Stop"></i>
                </div>
                <i class="fa-solid fa-redo {{#if loop}}active{{/if}}" data-action="loop-queue" title="Loop"
                  style="{{#if loop}}color: var(--accent-cyan);{{/if}}"></i>
                <i class="fa-solid fa-trash ase-btn-delete" data-action="remove-queue" title="Remove"></i>
              </div>
            </div>

            {{!-- Row 2: Tags + Channel --}}
            <div class="ase-track-row2">
              <div class="ase-channel-select" data-action="channel-dropdown">
                <span>{{group}}</span>
                <i class="fa-solid fa-chevron-down"></i>
              </div>
              <div class="ase-track-tags">
                {{#each tags}}
                <span class="ase-tag">#{{this}}</span>
                {{/each}}
              </div>
            </div>

            {{!-- Row 3: Timeline --}}
            <div class="ase-queue-track-timeline">
              <span class="ase-time-current">{{currentTimeFormatted}}</span>
              <input type="range" class="ase-seek-slider" data-action="seek" min="0" max="100" value="{{progress}}"
                step="0.1">
              <span class="ase-time-duration">{{durationFormatted}}</span>
            </div>

            {{!-- Row 4: Volume --}}
            <div class="ase-queue-track-volume">
              <i class="fa-solid fa-volume-low"></i>
              <input type="range" class="ase-volume-slider" data-action="volume" min="0" max="100"
                value="{{volumePercent}}">
              <span class="ase-volume-value">{{volumePercent}}%</span>
            </div>
          </div>
          {{/each}}
        </div>
      </div>
      {{/each}}
      {{else}}
      <div class="ase-empty-list-area">
        <center style="opacity: 0.5;">
          <i class="fa-solid fa-list" style="font-size: 48px; margin-bottom: 20px;"></i>
          <p>Queue is empty</p>
          <p style="font-size: 11px;">Add tracks from Favorites or Library</p>
        </center>
      </div>
      {{/if}}
    </div>
  </main>
</div>